<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Special Surprise! ðŸŽ‰</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }
        .confetti {
            position: absolute;
            animation: fall linear infinite;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-pink-100 via-purple-100 to-blue-100">
    <div id="confetti-container" class="fixed inset-0 pointer-events-none z-50"></div>
    
    <div class="min-h-screen flex items-center justify-center p-4">
        <div class="max-w-2xl w-full">
            <!-- Edit Screen -->
            <div id="edit-screen" class="bg-white rounded-3xl shadow-2xl p-8 text-center">
                <h1 class="text-4xl font-bold text-gray-800 mb-6">âœ¨ Create Your Scratch Card âœ¨</h1>
                <p class="text-gray-600 mb-6">Customize your message below, then let your friends scratch to reveal the big news!</p>
                
                <div class="mb-6">
                    <label class="block text-left text-gray-700 font-semibold mb-2">Your Message:</label>
                    <input 
                        type="text" 
                        id="message-input"
                        value="We're Having a Baby! ðŸ‘¶"
                        class="w-full px-4 py-3 text-2xl text-center border-2 border-purple-300 rounded-lg focus:outline-none focus:border-purple-500"
                        placeholder="We're Having a Baby! ðŸ‘¶"
                    >
                </div>

                <button 
                    onclick="createCard()"
                    class="bg-gradient-to-r from-pink-500 to-purple-500 text-white font-bold py-4 px-8 rounded-full text-xl hover:from-pink-600 hover:to-purple-600 transition-all transform hover:scale-105"
                >
                    Create Scratch Card
                </button>
            </div>

            <!-- Scratch Card Screen -->
            <div id="scratch-screen" class="bg-white rounded-3xl shadow-2xl p-8 hidden">
                <h1 class="text-3xl font-bold text-center text-gray-800 mb-6">ðŸŽ‰ You've Got a Surprise! ðŸŽ‰</h1>
                
                <div id="card-container" class="relative w-full h-96 bg-gradient-to-br from-pink-50 to-purple-50 rounded-2xl overflow-hidden shadow-inner">
                    <!-- Hidden message -->
                    <div class="absolute inset-0 flex items-center justify-center p-8">
                        <h2 id="reveal-message" class="text-4xl md:text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-pink-500 to-purple-500 text-center leading-tight">
                            We're Having a Baby! ðŸ‘¶
                        </h2>
                    </div>

                    <!-- Scratch canvas -->
                    <canvas 
                        id="scratch-canvas"
                        class="absolute inset-0 w-full h-full cursor-pointer"
                        style="touch-action: none;"
                    ></canvas>
                </div>

                <div id="progress-message" class="mt-6 text-center hidden">
                    <div class="inline-block bg-purple-100 rounded-full px-6 py-2">
                        <p id="progress-text" class="text-purple-700 font-semibold">Keep scratching... ðŸ’«</p>
                    </div>
                </div>

                <div class="mt-6 text-center">
                    <button 
                        onclick="resetCard()"
                        class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-6 rounded-full transition-all"
                    >
                        Change Message
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let isScratching = false;
        let scratchPercentage = 0;
        let canvas, ctx, container;
        let confettiShown = false;

        function createCard() {
            const message = document.getElementById('message-input').value.trim();
            if (!message) return;

            document.getElementById('reveal-message').textContent = message;
            document.getElementById('edit-screen').classList.add('hidden');
            document.getElementById('scratch-screen').classList.remove('hidden');

            setTimeout(initCanvas, 100);
        }

        function initCanvas() {
            canvas = document.getElementById('scratch-canvas');
            container = document.getElementById('card-container');
            ctx = canvas.getContext('2d');

            const rect = container.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = rect.height;

            // Create gradient
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, '#ffd700');
            gradient.addColorStop(0.5, '#ffa500');
            gradient.addColorStop(1, '#ff8c00');
            
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Add sparkle texture
            ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
            for (let i = 0; i < 150; i++) {
                const x = Math.random() * canvas.width;
                const y = Math.random() * canvas.height;
                const size = Math.random() * 3;
                ctx.fillRect(x, y, size, size);
            }

            // Add text
            ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
            ctx.font = 'bold 32px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
            ctx.shadowBlur = 5;
            ctx.fillText('Scratch Here! âœ¨', canvas.width / 2, canvas.height / 2);

            // Event listeners
            canvas.addEventListener('mousedown', handleMouseDown);
            canvas.addEventListener('mouseup', handleMouseUp);
            canvas.addEventListener('mousemove', handleMouseMove);
            canvas.addEventListener('mouseleave', handleMouseUp);
            canvas.addEventListener('touchstart', handleTouchStart);
            canvas.addEventListener('touchend', handleTouchEnd);
            canvas.addEventListener('touchmove', handleTouchMove);
        }

        function scratch(x, y) {
            const rect = container.getBoundingClientRect();
            const canvasX = x - rect.left;
            const canvasY = y - rect.top;

            ctx.globalCompositeOperation = 'destination-out';
            ctx.beginPath();
            ctx.arc(canvasX, canvasY, 30, 0, Math.PI * 2);
            ctx.fill();

            calculateScratchPercentage();
        }

        function calculateScratchPercentage() {
            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const pixels = imageData.data;
            let transparent = 0;
            
            for (let i = 3; i < pixels.length; i += 4) {
                if (pixels[i] === 0) transparent++;
            }
            
            scratchPercentage = (transparent / (pixels.length / 4)) * 100;

            if (scratchPercentage > 10) {
                document.getElementById('progress-message').classList.remove('hidden');
            }

            if (scratchPercentage > 60) {
                document.getElementById('progress-text').textContent = 'Congratulations! ðŸŽŠ';
                if (!confettiShown) {
                    showConfetti();
                    confettiShown = true;
                }
            }
        }

        function showConfetti() {
            const container = document.getElementById('confetti-container');
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti text-pink-400 text-2xl';
                confetti.textContent = 'âœ¨';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.top = '-20px';
                confetti.style.animationDuration = (2 + Math.random() * 3) + 's';
                confetti.style.animationDelay = Math.random() * 2 + 's';
                container.appendChild(confetti);
            }
        }

        function handleMouseDown(e) {
            isScratching = true;
            scratch(e.clientX, e.clientY);
        }

        function handleMouseUp() {
            isScratching = false;
        }

        function handleMouseMove(e) {
            if (isScratching) {
                scratch(e.clientX, e.clientY);
            }
        }

        function handleTouchStart(e) {
            e.preventDefault();
            isScratching = true;
            const touch = e.touches[0];
            scratch(touch.clientX, touch.clientY);
        }

        function handleTouchEnd() {
            isScratching = false;
        }

        function handleTouchMove(e) {
            e.preventDefault();
            if (isScratching && e.touches.length > 0) {
                const touch = e.touches[0];
                scratch(touch.clientX, touch.clientY);
            }
        }

        function resetCard() {
            document.getElementById('scratch-screen').classList.add('hidden');
            document.getElementById('edit-screen').classList.remove('hidden');
            document.getElementById('progress-message').classList.add('hidden');
            document.getElementById('confetti-container').innerHTML = '';
            scratchPercentage = 0;
            confettiShown = false;
        }
    </script>
</body>
</html>
